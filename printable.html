<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invitation Editor</title>
    <!-- Google Font Import -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Bricolage+Grotesque&display=swap" rel="stylesheet">
    <style>
        :root {
            --arena-dark-purple: #320775;
            --arena-purple: #44148f;
            --arena-magenta: #990099;
            --arena-pink: #ffb0db;
            --arena-green: #d5de58;
            --arena-light-gray: #eee;
            --arena-white: #fff;
            --arena-black: #090909;
            --arena-black-30: rgba(9, 9, 9, 0.43);
            --arena-dark-blue: #14088e;
            --arena-light-blue: #8ac2d9;
            --arena-blue: #3292e0;
            --arena-lavender: #be95ff;
            --arena-deep-purple: #8b40ff;
            --arena-light-purple: #d0a4e1;
            --arena-teal: #6cf7f3;
            --arena-dark-gray: #333;
            --arena-yellow: #edf763;
        }
        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: 'Roboto Mono', monospace;
            background-color: var(--arena-purple);
            color: white;
            margin: 20px;
            overflow: hidden; /* Prevent scrolling */
        }
        .editor-container {
            display: flex;
            gap: 40px;
        }
        .form-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            column-gap: 20px;
            row-gap: 15px;
            max-width: 600px;
            align-items: center;
        }
        .form-container label {
            display: flex;
            flex-direction: row;
            align-items: center;
            gap: 10px;
            grid-column: span 2;
        }
        .font-size-buttons {
            grid-column: span 2;
            display: flex;
            gap: 20px;
            align-items: center;
        }
        .font-size-buttons label {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .preview-wrapper {
            position: relative;
            width: 400px;
            height: 600px;
            overflow: hidden;
        }
        /* Full-resolution container scaled down for preview */
        .preview-container {
            position: absolute; /* Position absolute to remove impact on document flow */
            top: 0;
            left: 0;
            width: 1200px;
            height: 1800px;
            transform: scale(0.33); /* Scale down to show at ~400x600 */
            transform-origin: top left; /* Anchor scale to top left */
            border: none;
            background-color: var(--arena-dark-purple);
        }
        .preview-container img {
            width: 100%;
            height: 100%;
        }
        .overlay-text {
            position: absolute;
            color: black;
            font-size: 54px; /* Full size font */
            font-weight: bold;
            pointer-events: none;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-family: 'Roboto Mono', monospace; /* Apply Roboto Mono font */
            z-index: 5;
        }
        /* Specific positions for each text input at full resolution */
        #eventTitle {
            top: 648px; left: 91px; width: 1017px; height: 220px; 
        }
        #date {
            top: 944px; left: 91px; width: 1017px; height: 100px;
        }
        #startTime {
            top: 1162px; left: 91px; width: 485px; height: 100px;
        }
        #endTime {
            top: 1162px; right: 92px; width: 485px; height: 100px;
        }
        #rsvp {
            top: 1387px; left: 357px; width: 485px; height: 100px;
        }
        h1 {
            font-family: 'Bricolage Grotesque', sans-serif;
            text-align: center;
        }
        .boxshadow {
            border: 2px solid var(--arena-black);
            box-shadow: 0px 7px 0px var(--arena-black-30);
            border-radius: 8px;
            padding: 10px; /* Added padding for better visibility */
            font-size: 1.1rem; /* Increased font size */
            width: 100%;
        }
        button {
            font-family: 'Roboto Mono', monospace;
            font-size: 1.1rem;
            padding: 15px;
            background-color: var(--arena-magenta);
            color: var(--arena-white);
            border: 2px solid var(--arena-black);
            border-radius: 8px;
            box-shadow: 0px 7px 0px var(--arena-black-30);
            cursor: pointer;
            width: 100%;
            grid-column: span 2;
        }
        button:hover {
            background-color: var(--arena-purple);
            transition: 0.3s ease-in-out;
        }
        .font-size-buttons button {
            font-family: 'Roboto Mono', monospace;
            padding: 10px;
            background-color: var(--arena-magenta);
            color: var(--arena-white);
            border: 2px solid var(--arena-black);
            border-radius: 8px;
            cursor: pointer;
            width: 60px;
        }
        .font-size-buttons button:hover {
            background-color: var(--arena-purple);
            transition: 0.3s ease-in-out;
        }
.color-picker-container {
    position: relative;
    width: 40px;
    height: 40px;
    border-radius: 50%; /* Make it a perfect circle */
    border: 2px solid var(--arena-black);
    box-shadow: 0px 7px 0px var(--arena-black-30);
    cursor: pointer;
    background-color: #320775; /* Default color */
}

.color-picker-button {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0; /* Hide the color input but keep it clickable */
    cursor: pointer; /* Make sure users know they can click here */
}
.headershadow {
    text-shadow: 3px 3px 0px var(--arena-black-30);
}

.opacity-slider {
    width: 100%;
    grid-column: span 2;
    display: flex;
    align-items: center;
    gap: 10px;
}
    </style>
</head>
<body>

    <h1 class="headershadow">Customize Your Invitation</h1>
    <div class="editor-container">
        
        <!-- Input form -->
        <div class="form-container">
<label for="backgroundColor">
    Background Colour:
    <div class="color-picker-container" onclick="document.getElementById('backgroundColor').click()">
        <input type="color" id="backgroundColor" class="color-picker-button" value="#320775" oninput="updateBackgroundColor()">
    </div>
</label>

            
            <label for="eventTitleInput">
                <input type="text" id="eventTitleInput" class="boxshadow" style="font-family: 'Roboto Mono', monospace;" placeholder="Event Title" oninput="updateText('eventTitle')">
            </label>
            
            <label class="font-size-buttons" for="eventTitleFontSize">
                Event Title Font Size:
                <div>
                    <button onclick="updateFontSize('eventTitle', 'small')">S</button>
                    <button onclick="updateFontSize('eventTitle', 'medium')">M</button>
                    <button onclick="updateFontSize('eventTitle', 'large')">L</button>
                </div>
            </label>
            
            <label for="dateInput">
                <input type="text" id="dateInput" class="boxshadow" style="font-family: 'Roboto Mono', monospace;" placeholder="Date" oninput="updateText('date')">
            </label>
            
            <label for="startTimeInput">
                <input type="text" id="startTimeInput" class="boxshadow" style="font-family: 'Roboto Mono', monospace;" placeholder="Start Time" oninput="updateText('startTime')">
            </label>
            
            <label for="endTimeInput">
                <input type="text" id="endTimeInput" class="boxshadow" style="font-family: 'Roboto Mono', monospace;" placeholder="End Time" oninput="updateText('endTime')">
            </label>
            
            <label for="rsvpInput">
                <input type="text" id="rsvpInput" class="boxshadow" style="font-family: 'Roboto Mono', monospace;" placeholder="RSVP To" oninput="updateText('rsvp')">
            </label>
            
            <label class="opacity-slider">
                Overlay Opacity:
                <input type="range" id="overlayOpacity" min="0" max="1" step="0.01" value="1" oninput="updateOverlayOpacity()">
            </label>
            
            <button class="hero" onclick="saveImage()">Save Invitation</button>
        </div>

        <!-- Wrapper to control preview container overflow -->
        <div class="preview-wrapper">
            <div class="preview-container" id="imageContainer">
                <img src="https://sarnialasertag.com/printables/set_01/WavesOverlay.svg" alt="Overlay Image" id="overlayImage" style="opacity: 1; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1;">
                <img src="https://sarnialasertag.com/printables/set_01/template.svg" alt="Invitation Background" id="backgroundImage" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2;">
                <div class="overlay-text" id="eventTitle" style="z-index: 5">Robbie's Birthday!</div>
                <div class="overlay-text" id="date" style="z-index: 5">January 15, 2024</div>
                <div class="overlay-text" id="startTime" style="z-index: 5">5:30pm</div>
                <div class="overlay-text" id="endTime" style="z-index: 5">7:30pm</div>
                <div class="overlay-text" id="rsvp" style="z-index: 5">519 123 4567</div>
            </div>
        </div>

    </div>

    <script>
        // Function to update the text on the preview
        function updateText(id) {
            const inputValue = document.getElementById(id + "Input").value;
            document.getElementById(id).innerText = inputValue;
        }

        // Function to update the background color of the preview live as the color picker is used
function updateBackgroundColor() {
    const colorValue = document.getElementById("backgroundColor").value;
    document.querySelector('.color-picker-container').style.backgroundColor = colorValue; // Update color picker container background
    document.getElementById("imageContainer").style.backgroundColor = colorValue; // Update preview container as well
}

        // Function to update the font size of the event title
        function updateFontSize(id, size) {
            let fontSizeValue;
            if (size === 'small') {
                fontSizeValue = '36px';
            } else if (size === 'medium') {
                fontSizeValue = '54px';
            } else if (size === 'large') {
                fontSizeValue = '72px';
            }
            document.getElementById(id).style.fontSize = fontSizeValue;
        }

        // Function to update the opacity of the overlay image
        function updateOverlayOpacity() {
            const opacityValue = document.getElementById("overlayOpacity").value;
            document.getElementById("overlayImage").style.opacity = opacityValue;
        }

        function saveImage() {
            const container = document.getElementById("imageContainer");

            // Create a deep clone of the container
            const clone = container.cloneNode(true);
            clone.style.transform = "none"; // Remove the transform for full resolution
            clone.style.position = "absolute";
            clone.style.top = "-9999px"; // Position it off-screen
            clone.style.left = "-9999px"; // Position it off-screen
            document.body.appendChild(clone);

            // Capture the clone using html2canvas
            html2canvas(clone, {
                scale: 1, // Ensure full-size capture
                width: 1200,
                height: 1800
            }).then(canvas => {
                const link = document.createElement("a");
                link.href = canvas.toDataURL("image/png");
                link.download = "custom-invitation.png";
                link.click();

                // Remove the clone after capturing
                document.body.removeChild(clone);
            });
        }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.0.0-rc.5/dist/html2canvas.min.js"></script>

</body>
</html>